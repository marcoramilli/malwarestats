<!DOCTYPE html>
<html>
<head>
  <title>Malware Static Analysis Monitor</title>
  <link rel="stylesheet" type="text/css" href="assets/lib/bootstrap/dist/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="assets/css/keen-dashboards.css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/default.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
</head>
<body class="application">

  <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../">
          <span class="glyphicon glyphicon-chevron-left"></span>
        </a>
        <a class="navbar-brand" href="./">Home</a>
      </div>
      <div class="navbar-collapse collapse">
        <ul class="nav navbar-nav navbar-left">
          <li><a href="https://github.com/marcoramilli">Source</a></li>
          <li><a href="about.html">About This Site</a></li>
          <li><a href="tricks.html">Known Evasion Tricks</a></li>

        </ul>
      </div>
    </div>
  </div>

  <div class="container-fluid">

   <div class="row">
     <div class="col-sm-12">
       <div class="chart-wrapper">
         <div class="chart-title">
           <div class="chart-stage">
             Known Evasion Tricks divided by engaded system.

                <div class="row">

                <div class="col-sm-12">
                    <div class="chart-wrapper">
                      <div class="chart-title">
                        VMWare Envoronment :
                      </div>

                <div class="col-sm-3">
                    <div class="chart-wrapper">
                      <div class="chart-title">
                       MAC Addresses :
                      </div>
                      <pre><code class="C/AL">
00:05:69
00:0C:29
00:1C:14
00:50:56
</code></pre>
                    </div>
                </div>

                <div class="col-sm-3">
                    <div class="chart-wrapper">
                      <div class="chart-title">
                        VMWare Files : 
                      </div>
                      <pre><code class="C/AL">
C:\\WINDOWS\\system32\\drivers\\vmmouse.sys
C:\\WINDOWS\\system32\\drivers\\vmhgfs.sys
                      </code></pre>
                    </div>
                </div>

                <div class="col-sm-6">
                    <div class="chart-wrapper">
                      <div class="chart-title">
                        VMWare RegKeys: 
                      </div>
                      <pre><code class="C/AL">
(HKEY_LOCAL_MACHINE, "HARDWARE\\DEVICEMAP\\Scsi\\Scsi Port 0\\Scsi Bus 0\\Target Id 0\\Logical Unit Id 0", "Identifier", "VMWARE")

(HKEY_LOCAL_MACHINE, "HARDWARE\\DEVICEMAP\\Scsi\\Scsi Port 1\\Scsi Bus 0\\Target Id 0\\Logical Unit Id 0", "Identifier", "VMWARE")

(HKEY_LOCAL_MACHINE, "HARDWARE\\DEVICEMAP\\Scsi\\Scsi Port 2\\Scsi Bus 0\\Target Id 0\\Logical Unit Id 0", "Identifier", "VMWARE")

(HKEY_LOCAL_MACHINE, "SOFTWARE\\VMware, Inc.\\VMware Tools")
                      </code></pre>
                    </div>
                </div>


                </div>



           </div>
         </div>
       </div>
     </div>
<!--GeneralSANDBOX-->
                <div class="row">

                <div class="col-sm-12">
                    <div class="chart-wrapper">
                      <div class="chart-title">
                       General SandBox 
                      </div>

                <div class="col-sm-12">
                    <div class="chart-wrapper">
                      <div class="chart-title">
                        General Key Concepts:
                      </div>
                      <pre><code class="C/AL">
Mouse position: if ((position1.x == position2.x) && (position1.y == position2.y))

Generic User Names: VIRUS, SANDBOX, MALWARE, TEST

Sample Path: \\MALWARE, \\VIRUS, \\SAMPLE, \\SANDBOX, \\TEST

Driver: \\\\.\\PhysicalDrive0, C:\\

Sleep Patching: 
time1 = GetTickCount();
  Sleep(500);
  if ((GetTickCount() - time1) > 450 ) return FALSE;
  else return TRUE;

Number of Processors:
__asm__ volatile (
      "mov %%fs:0x18, %%eax;"
      "mov %%ds:0x30(%%eax), %%eax;"
      "mov %%ds:0x64(%%eax), %%eax;"
      : "=a"(NumberOfProcessors));
  return NumberOfProcessors < 2 ? TRUE : FALSE;

Memory Less than 1G:
MEMORYSTATUSEX statex;
  statex.dwLength = sizeof (statex);

  GlobalMemoryStatusEx(&statex);
  return (statex.ullTotalPhys/1024) < 1048576 ? TRUE : FALSE;

</code></pre>
                    </div>
                </div>


           </div>
         </div>
       </div>
<!--QEMU-->
                <div class="row">

                <div class="col-sm-12">
                    <div class="chart-wrapper">
                      <div class="chart-title">
                        QUEMU Environment:
                      </div>

                <div class="col-sm-12">
                    <div class="chart-wrapper">
                      <div class="chart-title">
                        RegKeys:
                      </div>
                      <pre><code class="C/AL">
(HKEY_LOCAL_MACHINE, "HARDWARE\\DEVICEMAP\\Scsi\\Scsi Port 0\\Scsi Bus 0\\Target Id 0\\Logical Unit Id 0", "Identifier", "QEMU")
(HKEY_LOCAL_MACHINE, "HARDWARE\\Description\\System", "SystemBiosVersion", "QEMU")
</code></pre>
                    </div>
                </div>


           </div>
         </div>
       </div>
<!--SANDBOXIE-->
                <div class="row">

                <div class="col-sm-12">
                    <div class="chart-wrapper">
                      <div class="chart-title">
                        SANDBoxie Environment:
                      </div>

                <div class="col-sm-12">
                    <div class="chart-wrapper">
                      <div class="chart-title">
                      DLL Detect: 
                      </div>
                      <pre><code class="C/AL">
GetModuleHandle("sbiedll.dll")
</code></pre>
                    </div>
                </div>


           </div>
         </div>
       </div>
       <!--WINE-->
                <div class="row">

                <div class="col-sm-12">
                    <div class="chart-wrapper">
                      <div class="chart-title">
                        WINE Environment:
                      </div>

                <div class="col-sm-12">
                    <div class="chart-wrapper">
                      <div class="chart-title">
                      RegKeys
                      </div>


                      <pre><code class="C/AL">
("kernel32.dll", "wine_get_unix_file_name")
(HKEY_CURRENT_USER, "SOFTWARE\\Wine")

</code></pre>
                    </div>
                </div>


           </div>
         </div>
       </div>

       <!--VIRTUALBOX-->
                <div class="row">

                <div class="col-sm-12">
                    <div class="chart-wrapper">
                      <div class="chart-title">
                        Virtual Box Envoronment :
                      </div>

                <div class="col-sm-3">
                    <div class="chart-wrapper">
                      <div class="chart-title">
                       Virtual Box Strings: 
                      </div>
                      <pre><code class="C/AL">
"vboxservice.exe" //Process

"vboxtray.exe" //Process

"VirtualBox Shared Folders" //Network Share

"VBoxTrayToolWndClass"  //TrayWindow

"VBoxTrayToolWnd" //TrayWindow

"\x08\x00\x27" //MAC Addresses"

"\\\\.\\VBoxMiniRdrDN"

"\\\\.\\pipe\\VBoxMiniRdDN"

"\\\\.\\VBoxTrayIPC"

"\\\\.\\pipe\\VBoxTrayIPC"
                      </code></pre>
                    </div>
                </div>

                <div class="col-sm-3">
                    <div class="chart-wrapper">
                      <div class="chart-title">
                       VirtualBox Files : 
                      </div>
                      <pre><code class="C/AL">
"\\system32\\vboxdisp.dll"

"\\system32\\vboxhook.dll"

"\\system32\\vboxmrxnp.dll"

"\\system32\\vboxogl.dll"

"\\system32\\vboxoglarrayspu.dll"

"\\system32\\vboxoglcrutil.dll"

"\\system32\\vboxoglerrorspu.dll"

"\\system32\\vboxoglfeedbackspu.dll"

"\\system32\\vboxoglpackspu.dll"

"\\system32\\vboxoglpassthroughspu.dll"

"\\system32\\vboxservice.exe"

"\\system32\\vboxtray.exe"

"\\system32\\VBoxControl.exe"

"\\oracle\\virtualbox guest additions\\"

"\\system32\\drivers\\VBoxMouse.sys"

"\\system32\\drivers\\VBoxGuest.sys"

"\\system32\\drivers\\VBoxSF.sys"

"\\system32\\drivers\\VBoxVideo.sys"
                      </code></pre>
                    </div>
                </div>

                <div class="col-sm-6">
                    <div class="chart-wrapper">
                      <div class="chart-title">
                        VMWare RegKeys: 
                      </div>
                      <pre><code class="C/AL">
(HKEY_LOCAL_MACHINE, "HARDWARE\\DEVICEMAP\\Scsi\\Scsi Port 0\\Scsi Bus 0\\Target Id 0\\Logical Unit Id 0", "Identifier", "VBOX")

(HKEY_LOCAL_MACHINE, "HARDWARE\\Description\\System", "SystemBiosVersion", "VBOX")

(HKEY_LOCAL_MACHINE, "SOFTWARE\\Oracle\\VirtualBox Guest Additions")

(HKEY_LOCAL_MACHINE, "HARDWARE\\Description\\System", "VideoBiosVersion", "VIRTUALBOX")

(HKEY_LOCAL_MACHINE, "HARDWARE\\ACPI\\DSDT\\VBOX__")

(HKEY_LOCAL_MACHINE, "HARDWARE\\ACPI\\FADT\\VBOX__")

(HKEY_LOCAL_MACHINE, "HARDWARE\\ACPI\\RSDT\\VBOX__")

(HKEY_LOCAL_MACHINE, "HARDWARE\\DESCRIPTION\\System", "SystemBiosDate", "06/23/99")

"SYSTEM\\ControlSet001\\Services\\VBoxGuest"

"SYSTEM\\ControlSet001\\Services\\VBoxMouse"

"SYSTEM\\ControlSet001\\Services\\VBoxService"

"SYSTEM\\ControlSet001\\Services\\VBoxSF"

"SYSTEM\\ControlSet001\\Services\\VBoxVideo"


                      </code></pre>
                    </div>
                </div>


                </div>



           </div>
         </div>
       </div>
     </div>

   </div>
   
   </div>

   <!--<div class="row">-->
      <!--<div class="col-sm-2">-->
        <!--[><div class="chart-wrapper"><]-->
            <!--<div class=" chart-stage">-->
              <!--<div class="circular2">-->
                <!--<img src="http://www.me.psu.edu/mrl/people/i1.jpg"/>-->
              <!--</div>-->
            <!--</div>-->
          <!--[></div><]-->
        <!--</div> -->
      <!--<div class="col-sm-10">-->
        <!--<div class="chart-wrapper">-->
          <!--<div class="chart-title">-->


            <!--Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis eget accumsan ex, semper viverra nibh. Aenean hendrerit bibendum tellus, ut fringilla eros rhoncus eu. Nullam sem elit, pulvinar at neque ac, dignissim auctor neque. Maecenas at cursus tellus. Donec varius sem justo, venenatis facilisis dolor auctor sed. In elementum sollicitudin nunc, vitae interdum velit tincidunt in. Quisque dignissim mauris et dapibus posuere. Cras in lacus erat. In hac habitasse platea dictumst.-->

            <!--Nunc ullamcorper augue nisl, sit amet sodales odio venenatis ac. Duis auctor quam non odio cursus interdum. Sed eu odio at velit maximus ullamcorper. Aliquam mattis nunc eu fringilla posuere. Donec pellentesque consectetur eros, vitae euismod dui faucibus id. Donec pulvinar orci lorem, ut pretium metus rhoncus eu. Duis dignissim a ex iaculis accumsan. Morbi tristique nulla eu nulla consectetur, nec tempus urna suscipit. Fusce at porta quam.-->

            <!--Integer at nisl elit. Nulla facilisi. Vestibulum orci arcu, lobortis id odio sit amet, tempus vulputate ex. Nulla malesuada tortor velit, tempor gravida est sagittis non. Donec cursus in elit ac molestie. Pellentesque iaculis nec arcu sed pretium. Aliquam blandit, orci at varius mattis, nulla turpis lobortis orci, at aliquet urna leo consequat dui. Sed consequat semper lectus, eu malesuada lacus auctor vitae. Praesent iaculis aliquam arcu finibus vehicula. Donec nec ligula velit. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.-->

          <!--</div>-->
        <!--</div>-->
      <!--</div>-->
   
   </div>
  </div>

    <!--<div class="row">-->
      <!--<div class="col-sm-3">-->
        <!--<div class="chart-wrapper">-->
          <!--<img data-src="holder.js/100%x150/white">-->
        <!--</div>-->
      <!--</div>-->
      <!--<div class="col-sm-3">-->
        <!--<div class="chart-wrapper">-->
          <!--<img data-src="holder.js/100%x150/white">-->
        <!--</div>-->
      <!--</div>-->
      <!--<div class="col-sm-3">-->
        <!--<div class="chart-wrapper">-->
          <!--<img data-src="holder.js/100%x150/white">-->
        <!--</div>-->
      <!--</div>-->
      <!--<div class="col-sm-3">-->
        <!--<div class="chart-wrapper">-->
          <!--<img data-src="holder.js/100%x150/white">-->
        <!--</div>-->
      <!--</div>-->
    <!--</div>-->

    <hr>

    <p class="small text-muted">Powered by <a href="https://marcoramilli.blogspot.com">Marco Ramilli</a></p>

  </div>

  <script type="text/javascript" src="assets/lib/jquery/dist/jquery.min.js"></script>
  <script type="text/javascript" src="assets/lib/bootstrap/dist/js/bootstrap.min.js"></script>

  <script type="text/javascript" src="assets/lib/holderjs/holder.js"></script>
  <script>
    Holder.add_theme("white", { background:"#fff", foreground:"#a7a7a7", size:10 });
  </script>

  <script type="text/javascript" src="assets/lib/keen-js/dist/keen.min.js"></script>
  <script type="text/javascript" src="assets/js/meta.js"></script>
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-5633272-10', 'auto');
                ga('send', 'pageview');

              </script>
</body>
</html>
